---
description: Codebase architecture patterns for the Signal-to-Code demo app
globs: ["**/src/**"]
alwaysApply: true
---

# Architecture Standards (Demo App)

## File Structure
- Services: `src/services/`
- API routes: `src/api/routes/`
- React components: `src/components/`
- Tests: `src/__tests__/` (mirrors source structure)
- Specs: `specs/`

## Stack
- Frontend: Vite + React (TypeScript)
- Backend: Express, TypeScript (run with tsx)
- Validation: Zod for API request bodies

## Conventions
- TypeScript strict mode
- camelCase for functions/variables
- PascalCase for components/classes/types
- kebab-case for filenames
- All API endpoints validated with Zod schemas

## Domain Language
- "workspace" (NOT "organization" or "tenant")
- "analytics" (NOT "metrics" or "stats")
- "export" (NOT "download")
- "member" (NOT "user" or "account")

## Testing (required per feature)
- **Every feature** must include tests under `src/__tests__/` that cover the spec’s acceptance criteria.
- **Minimum:** (1) Unit tests for new/updated services or pure logic (e.g. helpers, converters). (2) Integration tests for new/updated API routes (e.g. supertest against the app).
- **When applicable:** Component tests for non-trivial UI behavior (e.g. user flows, conditional visibility). E2E tests only when the spec or product explicitly requires them.
- Use vitest. Map test cases to acceptance criteria in the spec (e.g. “AC: valid request → 200” → test that posts valid body and expects 200).
- Run `npm test` after implementation; fix failures before considering the feature done.

## PR / Spec Traceability
- PR description must reference the spec file in `specs/`
- Tag relevant AEs/SEs from the originating customer calls when known
